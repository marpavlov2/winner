<div class="app-container">
  <app-header class="sticky top-0"></app-header>
  <div class="main-wrapper">
    <div class="container mx-auto text-white pb-4">
      <div class="flex items-center justify-between py-4">
        <div
          class="cursor-pointer bg-purple-900 rounded-lg py-2 px-3 flex items-center"
        >
          <ng-icon
            class="mr-2"
            name="heroBanknotes"
            (click)="copyMessage()"
          ></ng-icon>
          <h2 class="text-sm font-medium tracking-wide">Pot of Gold</h2>
        </div>

        <div class="flex items-center">
          <a href="" class="mr-2 text-white hover:text-slate-200">
            <svg
              viewBox="0 0 16 16"
              class="w-6 h-6"
              fill="currentColor"
              aria-hidden="true"
            >
              <path
                d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"
              ></path>
            </svg>
          </a>

          <a href="" class="mr-2 text-white hover:text-slate-200">
            <svg
              viewBox="0 0 18 18"
              class="w-6 h-6"
              fill="currentColor"
              aria-hidden="true"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M2.636 2.636A8.972 8.972 0 0 1 9 0a8.972 8.972 0 0 1 6.364 2.636A8.972 8.972 0 0 1 18 9a8.972 8.972 0 0 1-2.636 6.364A8.972 8.972 0 0 1 9 18a8.972 8.972 0 0 1-6.364-2.636A8.972 8.972 0 0 1 0 9a8.972 8.972 0 0 1 2.636-6.364Zm6.421 3.645c-.895.38-2.685 1.168-5.37 2.362-.435.177-.664.35-.685.52-.035.285.316.398.794.551l.201.066c.47.156 1.103.338 1.432.346.298.006.63-.12.998-.377 2.508-1.729 3.803-2.602 3.885-2.621.057-.014.136-.03.19.019.054.049.049.141.043.166-.035.151-1.412 1.459-2.125 2.135-.222.211-.38.361-.412.395-.072.077-.146.15-.217.219-.437.43-.764.752.018 1.279.376.253.677.462.977.67.328.228.655.456 1.078.739.108.072.211.147.311.22.382.278.725.527 1.148.487.246-.023.5-.259.63-.964.304-1.665.904-5.272 1.043-6.759a1.7 1.7 0 0 0-.016-.37.4.4 0 0 0-.13-.255.597.597 0 0 0-.358-.109c-.346.006-.877.195-3.435 1.281Z"
                fill="currentColor"
              ></path>
            </svg>
          </a>

          <a href="" class="text-white hover:text-slate-200">
            <svg
              viewBox="0 0 18 18"
              class="w-6 h-6"
              fill="currentColor"
              aria-hidden="true"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M2.636 2.636A8.972 8.972 0 0 1 9 0a8.972 8.972 0 0 1 6.364 2.636A8.972 8.972 0 0 1 18 9a8.972 8.972 0 0 1-2.636 6.364A8.972 8.972 0 0 1 9 18a8.972 8.972 0 0 1-6.364-2.636A8.972 8.972 0 0 1 0 9a8.972 8.972 0 0 1 2.636-6.364Zm10.356 4.655v-.262A3.75 3.75 0 0 0 14 5.955c-.367.17-.76.275-1.178.328.419-.262.746-.655.903-1.139a4.17 4.17 0 0 1-1.309.497A2.043 2.043 0 0 0 10.924 5 2.05 2.05 0 0 0 8.87 7.055c0 .157.013.327.052.471A5.838 5.838 0 0 1 4.694 5.38a2.1 2.1 0 0 0-.275 1.034c0 .72.366 1.348.916 1.714a2.016 2.016 0 0 1-.93-.262v.027c0 .994.708 1.819 1.65 2.002a1.902 1.902 0 0 1-.93.04 2.031 2.031 0 0 0 1.912 1.426A4.153 4.153 0 0 1 4 12.212c.916.576 1.99.916 3.154.916 3.77 0 5.838-3.128 5.838-5.837Z"
                fill="currentColor"
              ></path>
            </svg>
          </a>
        </div>
      </div>

      <div class="p-4 mb-8 bg-light-purple rounded-lg">
        <div
          class="bg-radial-gradient rounded-lg flex flex-col items-center justify-center p-4 text-white"
        >
          <span class="text-3xl mb-2 font-bold">WIN THIS ROUND</span>
          <div class="flex flex-row items-center">
            <img
              src="../../assets/ton_symbol.svg"
              alt="ton-symbol"
              height="32"
              width="32"
            />
            <span class="text-lg">
              {{ mainContractService.lockedBalance || 0 }} TON
            </span>
          </div>
        </div>

        <div
          class="bg-dark-purple p-4 my-4 rounded-lg flex items-center justify-between"
        >
          <div class="md:flex items-center overflow-hidden">
            <p>Deposit Address:</p>
            <div class="flex items-center">
              <span class="text-gray-300 truncate">
                {{ mainContractService.contractAddress }}
              </span>
              <div class="flex items-center mx-2">
                <ng-icon
                  class="cursor-pointer"
                  name="heroClipboardDocument"
                  (click)="copyMessage()"
                ></ng-icon>
              </div>
            </div>
          </div>
          <div class="flex items-center">
            <ng-icon
              class="cursor-pointer"
              name="heroQrCode"
              (click)="qrCodeDialog()"
            ></ng-icon>
          </div>
        </div>

        <p class="text-center mb-2 text-lg">
          Players in round:
          <span> {{ mainContractService.playersCurrent || 0 }}</span> /
          <span> {{ mainContractService.playersMax || 0 }}</span>
        </p>
        <!-- Step Progress -->
        <div class="w-full flex items-center gap-x-1 mb-4">
          <div
            *ngFor="
              let num of [].constructor(mainContractService.playersMax);
              let i = index
            "
            [ngClass]="{
              'bg-green-400': i < mainContractService.playersCurrent,
              'bg-gray-100': i >= mainContractService.playersCurrent
            }"
            class="w-full h-2.5 flex flex-col justify-center overflow-hidden text-xs text-center whitespace-nowrap"
            role="progressbar"
            aria-valuenow="25"
            aria-valuemin="0"
            aria-valuemax="100"
          ></div>
        </div>
        <!-- End Step Progress -->

        <div class="flex justify-center mb-4">
          <p
            class="mr-6 cursor-pointer text-green-400 hover:text-slate-200"
            (click)="openInfoDialog()"
          >
            How it Works?
          </p>
        </div>

        <div class="flex justify-center text-lg">
          <span>
            Min Bet:
            <span class="text-gray-300">
              {{ mainContractService.betMin || 0 }} TON
            </span>
          </span>

          <span>&nbsp;</span>
          <span>&nbsp;</span>

          <span>
            Max Bet:
            <span class="text-gray-300">
              {{ mainContractService.betMax || 0 }} TON
            </span>
          </span>
        </div>
      </div>

      <div class="flex items-center justify-between mb-6">
        <h2 class="text-xl font-light">Current Round:</h2>
      </div>
      <div class="mb-8">
        <div
          *ngIf="
            mainContractService.currentRound.length;
            else noPlayersCurrentRound
          "
        >
          <div
            *ngFor="
              let player of mainContractService.currentRound;
              let i = index
            "
          >
            <app-player
              [player]="player"
              [index]="i"
              [totalPlayers]="mainContractService.currentRound.length"
            ></app-player>
          </div>
        </div>

        <ng-template #noPlayersCurrentRound>
          <div class="flex flex-col items-center justify-center p-4">
            <ng-icon size="32px" class="mb-2" name="heroUsers"></ng-icon>
            <p class="font-lg">No player bets in this round</p>
          </div>
          <p></p>
        </ng-template>
      </div>

      <div class="flex items-center justify-between mb-6">
        <h2 class="text-xl font-light">Last Round:</h2>
        <div class="font-medium bg-green-400 rounded-lg py-2 px-3">
          <span>Lucky Ticket:</span>
          <span>&nbsp;</span>
          <span>
            {{ mainContractService.closestTicket || 0 }}
          </span>
        </div>
      </div>

      <app-player
        *ngIf="mainContractService.winner"
        [player]="mainContractService.winner"
        [index]="0"
        [totalPlayers]="mainContractService.playersMax + 1"
      ></app-player>

      <div
        *ngIf="mainContractService.lastRound.length; else noPlayersLastRound"
      >
        <div
          *ngFor="let player of mainContractService.lastRound; let i = index"
        >
          <app-player
            [player]="player"
            [index]="i"
            [totalPlayers]="mainContractService.lastRound.length"
          ></app-player>
        </div>
      </div>

      <ng-template #noPlayersLastRound>
        <div class="flex flex-col items-center justify-center p-4">
          <ng-icon size="32px" class="mb-2" name="heroUsers"></ng-icon>
          <p class="font-lg">No player bets in last round</p>
        </div>
        <p></p>
      </ng-template>
    </div>
  </div>
</div>

<div class="app-container">
  <app-header class="sticky top-0"></app-header>
  <div class="main-wrapper">
    <div class="container mx-auto text-white pb-4">
      <div class="flex items-center justify-end py-4">
        <app-social-icons></app-social-icons>
      </div>

      <div class="p-4 mb-4 bg-light-purple rounded-lg">
        <div class="flex flex-col-reverse sm:flex-row justify-between">
          <div class="flex flex-col justify-between mr-2">
            <div class="flex flex-col text-center sm:text-left mb-4 sm:mb-0">
              <h2 class="font-light mb-2">Deposit Address:</h2>
              <div class="md:flex items-center overflow-hidden">
                <div class="flex items-center">
                  <span class="truncate mr-2">
                    {{ mainContractService.contractAddress }}
                  </span>

                  <ng-icon
                    class="min-w-7 cursor-pointer"
                    name="heroClipboardDocument"
                    (click)="copyMessage()"
                  ></ng-icon>
                </div>
              </div>
            </div>

            <div class="flex justify-center sm:justify-start">
              <span class="bg-dark-purple p-2 text-sm">
                Min Bet:
                <span class="text-gray-300">
                  {{ mainContractService.betMin || 0 }} TON
                </span>
              </span>

              <span>&nbsp;</span>
              <span>&nbsp;</span>

              <span class="bg-dark-purple p-2 text-sm">
                Max Bet:
                <span class="text-gray-300">
                  {{ mainContractService.betMax || 0 }} TON
                </span>
              </span>
            </div>
          </div>

          <div class="flex justify-center">
            <img
              src="../../assets/qr-code.svg"
              alt="ton-symbol"
              height="132"
              width="132"
            />
          </div>
        </div>
      </div>

      <div
        class="bg-radial-gradient rounded-lg flex flex-col items-center justify-center p-4 text-white mb-4"
      >
        <span class="text-3xl mb-2 font-bold tracking-wider">REWARD</span>
        <div class="flex flex-row items-center">
          <img
            src="../../assets/ton_symbol.svg"
            alt="ton-symbol"
            height="32"
            width="32"
          />
          <span class="text-lg">
            {{ mainContractService.lockedBalance || 0 }} TON
          </span>
        </div>
      </div>

      <div class="bg-light-purple rounded-lg p-4 mb-4">
        <div class="flex items-center justify-between">
          <h2 class="font-light mb-4">Players in round:</h2>
          <div>
            <span> {{ mainContractService.playersCurrent || 0 }}</span> /
            <span> {{ mainContractService.playersMax || 0 }}</span>
          </div>
        </div>
        <!-- Step Progress -->
        <div class="step-progress w-full flex items-center gap-x-1 mb-4">
          <div
            *ngFor="
              let num of [].constructor(mainContractService.playersMax);
              let i = index
            "
            [ngClass]="{
              'bg-green-400': i < mainContractService.playersCurrent,
              'bg-gray-100': i >= mainContractService.playersCurrent
            }"
            class="w-full h-2.5 flex flex-col justify-center overflow-hidden text-xs text-center whitespace-nowrap"
            role="progressbar"
            aria-valuenow="25"
            aria-valuemin="0"
            aria-valuemax="100"
          ></div>
        </div>
        <!-- End Step Progress -->
      </div>

      <div class="sm:bg-light-purple rounded-lg sm:p-6 mb-4">
        <h2 class="font-light mb-6">Current Round:</h2>
        <div class="mb-8">
          <div
            *ngIf="
              mainContractService.currentRound.length;
              else noPlayersCurrentRound
            "
          >
            <div
              *ngFor="
                let player of mainContractService.currentRound;
                let i = index
              "
            >
              <app-player
                [player]="player"
                [index]="i"
                [totalPlayers]="mainContractService.currentRound.length"
              ></app-player>
            </div>
          </div>

          <ng-template #noPlayersCurrentRound>
            <div class="flex flex-col items-center justify-center p-4">
              <ng-icon size="32px" class="mb-2" name="heroUsers"></ng-icon>
              <p class="font-lg">No player bets in this round</p>
            </div>
            <p></p>
          </ng-template>
        </div>
      </div>

      <div class="sm:bg-light-purple rounded-lg sm:p-6">
        <div class="flex items-center justify-between mb-6">
          <h2 class="font-light">Last Round:</h2>

          <div class="flex justify-center">
            <div
              class="flex items-center justify-center bg-light-purple sm:bg-dark-purple py-2 px-4 rounded-lg"
            >
              <span class="text-xs tracking-wider uppercase font-medium">
                Lucky Ticket:
              </span>
              <span>&nbsp;</span>
              <span>
                {{ mainContractService.closestTicket || 0 }}
              </span>
            </div>
          </div>
        </div>

        <app-player
          *ngIf="mainContractService.winner"
          [player]="mainContractService.winner"
          [index]="0"
          [totalPlayers]="mainContractService.playersMax + 1"
        ></app-player>

        <div
          *ngIf="mainContractService.lastRound.length; else noPlayersLastRound"
        >
          <div
            *ngFor="let player of mainContractService.lastRound; let i = index"
          >
            <app-player
              [player]="player"
              [index]="i"
              [totalPlayers]="mainContractService.lastRound.length"
            ></app-player>
          </div>
        </div>

        <ng-template #noPlayersLastRound>
          <div class="flex flex-col items-center justify-center p-4">
            <ng-icon size="32px" class="mb-2" name="heroUsers"></ng-icon>
            <p class="font-lg">No player bets in last round</p>
          </div>
          <p></p>
        </ng-template>
      </div>
    </div>
  </div>
</div>
